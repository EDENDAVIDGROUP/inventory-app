<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8">
  <title>×”×–×× ×•×ª ×—×“×©×•×ª</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f5f5f5;
      padding: 30px;
    }

    h2 {
      margin-bottom: 30px;
    }

    .table th,
    .table td {
      vertical-align: middle;
    }

    .btn-group .btn,
    .bulk-actions .btn {
      margin-left: 5px;
    }

    .tag {
      display: inline-block;
      background-color: #d1e7dd;
      color: #0f5132;
      border-radius: 20px;
      padding: 5px 10px;
      margin: 2px;
    }

    .tag button {
      background: none;
      border: none;
      margin-right: 5px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
  <link href="assets/css/styles.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script src="assets/js/scripts.js" defer></script>
</head>

<body>
  <div class="container">
    <h2 class="text-center">×”×–×× ×•×ª ×—×“×©×•×ª</h2>


    <!-- Modal ×”×–× ×ª ×”×–×× ×” ×™×“× ×™×ª -->
    <div class="modal fade" id="manualOrderModal" tabindex="-1" aria-labelledby="manualOrderLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="manualOrderLabel">×”×–× ×ª ×”×–×× ×” ×—×“×©×”</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="manualOrderForm">
              <div class="mb-2"><input class="form-control" placeholder="×©× ×œ×§×•×—" id="manualName" required></div>
              <div class="mb-2"><input class="form-control" placeholder="×˜×œ×¤×•×Ÿ" id="manualPhone" required></div>
              <div class="mb-2"><input class="form-control" placeholder="×¢×™×¨" id="manualCity" required></div>
              <div class="mb-2"><input class="form-control" placeholder="××•×¦×¨" id="manualProduct" required></div>
              <div class="mb-2"><input type="number" class="form-control" placeholder="×›××•×ª" id="manualQuantity" min="1"
                  required></div>
              <div class="mb-2">
                <select class="form-select" id="manualPlatform">
                  <option value="">×‘×—×¨ ×¤×œ×˜×¤×•×¨××”</option>
                  <option value="×˜×œ×¤×•× ×™">×˜×œ×¤×•× ×™</option>
                  <option value="BOXMASTER">BOXMASTER</option>
                  <option value="PRO-TOOLS">PRO-TOOLS</option>
                  <option value="××•×¢×“×•×Ÿ ×˜×•×‘">××•×¢×“×•×Ÿ ×˜×•×‘</option>
                </select>
              </div>
              <div class="mb-2">
                <select class="form-select" id="manualShipping">
                  <option value="">×‘×—×¨ ×©×™×˜×ª ×©×™×œ×•×—</option>
                  <option value="××©×œ×•×—">××©×œ×•×—</option>
                  <option value="× ×§×•×“×ª ××™×¡×•×£">× ×§×•×“×ª ××™×¡×•×£</option>
                  <option value="××™×¡×•×£ ×¢×¦××™">××™×¡×•×£ ×¢×¦××™</option>
                  <option value="×—×¨×™×’">×—×¨×™×’</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary w-100">×©××•×¨ ×”×–×× ×”</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- ×¡×™× ×•×Ÿ -->
    <div class="card p-3 mb-4">
      <div class="card-body">
        <div class="d-flex flex-wrap align-items-end gap-3 justify-content-between flex-row-reverse"
          style="direction: rtl;">

          <!-- ğŸ‘¤ Platform -->
          <div>
            <label class="form-label fw-semibold text-muted text-end" style="color: #4d526c;">×¤×œ×˜×¤×•×¨××”</label>
            <select class="form-select rounded-pill shadow-sm border-0 px-3 text-end" id="platformFilter"
              style="background-color: #f9fafb;">
              <option value="">×”×›×œ</option>
              <option value="×˜×œ×¤×•× ×™">×˜×œ×¤×•× ×™</option>
              <option value="BOXMASTER">BOXMASTER</option>
              <option value="PRO-TOOLS">PRO-TOOLS</option>
              <option value="××•×¢×“×•×Ÿ ×˜×•×‘">××•×¢×“×•×Ÿ ×˜×•×‘</option>
            </select>
          </div>

          <!-- ğŸ“¦ Status -->
          <div>
            <label class="form-label fw-semibold text-muted text-end" style="color: #4d526c;">×¡×˜×˜×•×¡</label>
            <select class="form-select rounded-pill shadow-sm border-0 px-3 text-end" id="statusFilter"
              style="background-color: #f9fafb;">
              <option value="">×”×›×œ</option>
              <option value="×”×–×× ×” ×—×“×©×”">×”×–×× ×” ×—×“×©×”</option>
              <option value="×‘×˜×™×¤×•×œ">×‘×˜×™×¤×•×œ</option>
              <option value="×”×•×©×œ××”">×”×•×©×œ××”</option>
              <option value="×©×’×•×™×”">×©×’×•×™×”</option>
              <option value="×œ××©×œ×•×—">×œ××©×œ×•×—</option>
            </select>
          </div>

          <!-- ğŸšš Shipping Method -->
          <div>
            <label class="form-label fw-semibold text-muted text-end" style="color: #4d526c;">×©×™×˜×ª ×©×™×œ×•×—</label>
            <select class="form-select rounded-pill shadow-sm border-0 px-3 text-end" id="shippingFilter"
              style="background-color: #f9fafb;">
              <option value="">×”×›×œ</option>
              <option value="××©×œ×•×—">××©×œ×•×—</option>
              <option value="× ×§×•×“×ª ××™×¡×•×£">× ×§×•×“×ª ××™×¡×•×£</option>
              <option value="××™×¡×•×£ ×¢×¦××™">××™×¡×•×£ ×¢×¦××™</option>
              <option value="×—×¨×™×’">×—×¨×™×’</option>
            </select>
          </div>

          <!-- ğŸ” General Search -->
          <div class="flex-grow-1" style="min-width: 150px; max-width: 200px;">
            <label class="form-label fw-semibold text-muted text-end" style="color: #4d526c;">×—×™×¤×•×© ×›×œ×œ×™</label>
            <div class="input-group rounded-pill shadow-sm flex-row-reverse">
              <span class="input-group-text bg-white border-0"><i class="bi bi-search text-muted"></i></span>
              <input type="text" class="form-control border-0 py-1 text-end" id="searchInput"
                style="background-color: #f9fafb; font-size: 0.9rem;" placeholder="×—×¤×© ×œ×¤×™ ××–×”×”, ×ª××¨×™×š, ×œ×§×•×—...">
            </div>
          </div>

          <!-- ğŸ”˜ Buttons -->
          <div class="d-flex gap-2">
            <button class="btn btn-outline-dark rounded-pill px-4" style="border-color: #6e728c; color: #4d526c;"
              onclick="resetFilters()">
              <i class="bi bi-arrow-counterclockwise ms-1"></i> ××™×¤×•×¡
            </button>
            <button class="btn btn-dark rounded-pill px-4" style="background-color: #6e728c; border-color: #6e728c;"
              onclick="filterTable()">
              <i class="bi bi-funnel ms-1"></i> ×¡×™× ×•×Ÿ
            </button>
          </div>

        </div>
      </div>
    </div>

    <!-- ×¤×¢×•×œ×•×ª ××¨×•×‘×•×ª -->
    <div class="bulk-actions mb-3">
      <div class="btn-group">
        <button class="btn btn-success" onclick="routeSelected('×‘×˜×™×¤×•×œ')">× ×ª×‘ ×œ×”×–×× ×•×ª ×‘×˜×™×¤×•×œ</button>
        <button class="btn btn-danger" onclick="routeSelected('×©×’×•×™×”')">× ×ª×‘ ×œ×”×–×× ×•×ª ×©×’×•×™×•×ª</button>
        <button class="btn btn-primary" onclick="routeSelected('×œ××©×œ×•×—')">× ×ª×‘ ×œ××©×œ×•×—×™×</button>
      </div>
    </div>

    <!-- ×˜×‘×œ×ª ×”×–×× ×•×ª -->
    <table class="table table-bordered text-center" id="ordersTable">
      <thead class="table-dark">
        <tr>
          <th><input type="checkbox" id="selectAll"></th>
          <th>×ª××¨×™×š</th>
          <th>××¡' ×”×–×× ×”</th>
          <th>×©× ×œ×§×•×—</th>
          <th>×˜×œ×¤×•×Ÿ</th>
          <th>×¢×™×¨</th>
          <th>×¤×œ×˜×¤×•×¨××”</th>
          <th>×›××•×ª</th>
          <th>××•×¦×¨</th>
          <th>×¡×˜×˜×•×¡</th>
          <th>×©×™×˜×ª ×©×™×œ×•×—</th>
          <th>×¤×¢×•×œ×•×ª</th>
        </tr>
      </thead>
      <tbody id="ordersBody"></tbody>
    </table>
  </div>

  <script>
    const demoOrders = Array.from({ length: 20 }, (_, i) => {
      const cities = ['×ª×œ ××‘×™×‘', '×—×™×¤×”', '×™×¨×•×©×œ×™×', '×‘××¨ ×©×‘×¢', '××©×“×•×“', '× ×ª× ×™×”', '×¨×—×•×‘×•×ª', '×”×¨×¦×œ×™×”'];
      const platforms = ['BOXMASTER', 'PRO-TOOLS', '××•×¢×“×•×Ÿ ×˜×•×‘'];
      const products = ['××¦× ×Ÿ ARPO 5500', '××•×”×œ 3x3', '×’× ×¨×˜×•×¨ 2500W', '×©×•×œ×—×Ÿ ×¤×¢×™×œ×•×ª ×¢×¥'];
      const shipping = ['××©×œ×•×—', '× ×§×•×“×ª ××™×¡×•×£', '××™×¡×•×£ ×¢×¦××™', '×—×¨×™×’'];

      return {
        date: '06/07/2025',
        id: 1001 + i,
        name: `×œ×§×•×— ${i + 1}`,
        phone: `05${Math.floor(10000000 + Math.random() * 89999999)}`,
        city: cities[i % cities.length],
        platform: platforms[i % platforms.length],
        quantity: 1 + (i % 3),
        product: products[i % products.length],
        status: '×”×–×× ×” ×—×“×©×”',
        shipping: shipping[i % shipping.length],
      };
    });

    const importedOrders = JSON.parse(localStorage.getItem('importedOrders')) || [];
    let orders = [...demoOrders, ...importedOrders];

    function displayOrders(list) {
      const tbody = document.getElementById('ordersBody');
      tbody.innerHTML = '';

      list.forEach(order => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><input type="checkbox" class="order-checkbox" data-id="${order.id}"></td>
          <td>${order.date}</td>
          <td>${order.id}</td>
          <td>${order.name}</td>
          <td>${order.phone}</td>
          <td>${order.city}</td>
          <td>${order.platform}</td>
          <td>${order.quantity}</td>
          <td>${order.product}</td>
          <td><span class="badge bg-warning status">${order.status}</span></td>
          <td><span class="badge bg-primary">${order.shipping}</span></td>
          <td>
            <a href="edit-order.html?orderId=${order.id}" class="btn btn-outline-secondary btn-sm">×¢×¨×•×š</a>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function routeSelected(targetStatus) {
      const checkboxes = document.querySelectorAll('.order-checkbox:checked');
      const idsToRoute = Array.from(checkboxes).map(cb => parseInt(cb.dataset.id));
      const routedOrders = orders.filter(o => idsToRoute.includes(o.id));
      routedOrders.forEach(order => order.status = targetStatus);

      const storageKey = targetStatus === '×‘×˜×™×¤×•×œ' ? 'processingOrders'
        : targetStatus === '×©×’×•×™×”' ? 'errorOrders'
          : targetStatus === '×œ××©×œ×•×—' ? 'shippingOrders'
            : null;

      if (storageKey) {
        const existing = JSON.parse(localStorage.getItem(storageKey) || '[]');
        localStorage.setItem(storageKey, JSON.stringify([...existing, ...routedOrders]));
      }

      orders = orders.filter(o => !idsToRoute.includes(o.id));
      localStorage.setItem('importedOrders', JSON.stringify(orders));
      displayOrders(orders);
    }

    function applyFilters() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const platform = document.getElementById('platformFilter').value;
      const status = document.getElementById('statusFilter').value;
      const shipping = document.getElementById('shippingFilter').value;

      const filtered = orders.filter(order => {
        const text = `${order.id} ${order.name} ${order.phone} ${order.city}`.toLowerCase();
        return (!search || text.includes(search)) &&
          (!platform || order.platform === platform) &&
          (!status || order.status === status) &&
          (!shipping || order.shipping === shipping);
      });

      displayOrders(filtered);
    }

    function resetFilters() {
      document.getElementById('searchInput').value = '';
      document.getElementById('platformFilter').value = '';
      document.getElementById('statusFilter').value = '';
      document.getElementById('shippingFilter').value = '';
      displayOrders(orders);
    }

    document.getElementById('selectAll').addEventListener('change', function () {
      document.querySelectorAll('.order-checkbox').forEach(cb => cb.checked = this.checked);
    });
    document.getElementById('searchInput').addEventListener('input', applyFilters);
    document.getElementById('platformFilter').addEventListener('change', applyFilters);
    document.getElementById('statusFilter').addEventListener('change', applyFilters);
    document.getElementById('shippingFilter').addEventListener('change', applyFilters);

    document.getElementById('manualOrderForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const newOrder = {
        id: Date.now(),
        date: new Date().toLocaleDateString('he-IL'),
        name: document.getElementById('manualName').value,
        phone: document.getElementById('manualPhone').value,
        city: document.getElementById('manualCity').value,
        platform: document.getElementById('manualPlatform').value || '×˜×œ×¤×•× ×™',
        quantity: parseInt(document.getElementById('manualQuantity').value),
        product: document.getElementById('manualProduct').value,
        status: '×”×–×× ×” ×—×“×©×”',
        shipping: document.getElementById('manualShipping').value || '××©×œ×•×—'
      };
      orders.unshift(newOrder);
      localStorage.setItem('importedOrders', JSON.stringify(orders));
      displayOrders(orders);
      document.getElementById('manualOrderForm').reset();
      const modal = bootstrap.Modal.getInstance(document.getElementById('manualOrderModal'));
      modal.hide();
    });

    displayOrders(orders);
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  window.addEventListener('load', function () {
    fetch('includes/toolbar.html')
      .then(response => response.text())
      .then(html => {
        // Insert the toolbar at the top of the body
        document.body.insertAdjacentHTML('afterbegin', html);

        // Handle page-specific buttons (this block changes per page)
        const checkExist = setInterval(() => {
          const btnContainer = document.getElementById('page-specific-buttons');
          if (btnContainer) {
            clearInterval(checkExist); // Stop checking once found

            // Example: New Orders page
            btnContainer.innerHTML = `
              <button class="btn btn-outline-primary" onclick="document.getElementById('fileInput').click()">×™×™×‘×•× ×”×–×× ×•×ª</button>
              <input type="file" id="fileInput" accept=".xlsx, .xls" style="display: none" />
              <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#manualOrderModal">×™×¦×™×¨×ª ×”×–×× ×” ×—×“×©×”</button>
            `;
          }
        }, 50);

        // Add scroll effect to toolbar (transparent â†’ white)
        const toolbar = document.querySelector(".fixed-toolbar");
        window.addEventListener("scroll", function () {
          if (window.scrollY > 50) {
            toolbar.classList.add("scrolled");
          } else {
            toolbar.classList.remove("scrolled");
          }
        });
      })
      .catch(error => console.error('Error loading toolbar:', error));
  });
</script>

</body>

</html>